(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{135:function(e,t,n){"use strict";var r=n(49);n.n(r).a},18:function(e,t,n){"use strict";n.r(t);n(38),n(86);var r,i,o=n(59),a=n.n(o),s=(n(60),n(61)),c=n.n(s),u=n(45),l=n(4),d=n(33),f={data:function(){return{mobile:"",text:"获取验证码",smsToken:"",code:"",verifyCode:""}},methods:{isTel:function(){if(this.mobile){if(Object(d.isTel)(this.mobile))return!0;Object(l.Toast)("手机号格式错误")}else Object(l.Toast)("请输入手机号")},isCode:function(){if(this.verifyCode)return!0;Object(l.Toast)("请输入验证码")},getCode:(i=c()(a.a.mark(function e(t){var n,r,i,o,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target,r=this,this.isTel()){e.next=4;break}return e.abrupt("return");case 4:if(!n._disabled){e.next=6;break}return e.abrupt("return");case 6:return n._disabled=!0,e.prev=7,e.next=10,Object(u.c)();case 10:return i=e.sent.data.data.token,o={access_token:i,mobile:this.mobile},e.next=14,Object(u.b)(o);case 14:n.setAttribute("disabled",!0),s=(new Date).getTime()+9e4,function e(){if(s-(new Date).getTime()<=0)return n._disabled=!1,r.text="获取验证码",void n.removeAttribute("disabled");r.text="".concat(Math.ceil((s-(new Date).getTime())/1e3),"s"),setTimeout(function(){e()},1e3)}(),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),Object(l.Toast)(e.t0.meta.message||"获取验证码失败");case 22:return e.prev=22,n._disabled=!1,e.finish(22);case 25:case"end":return e.stop()}},e,this,[[7,19,22,25]])})),function(e){return i.apply(this,arguments)}),handleBind:(r=c()(a.a.mark(function e(){var t,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isTel()&&this.isCode()){e.next=2;break}return e.abrupt("return");case 2:return t={mobile:this.mobile,code:this.$refs.code.value},e.prev=3,e.next=6,Object(u.a)(t);case 6:n=e.sent,console.log(n),r=n.data.data.token,Object(d.setCookie)("TOKEN",r,1008e4),this.$router.push("/"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(3),console.log(e.t0),Object(l.Toast)("绑定失败");case 17:return e.prev=17,console.log("sss"),e.finish(17);case 20:case"end":return e.stop()}},e,this,[[3,13,17,20]])})),function(){return r.apply(this,arguments)}),handleInput:function(){console.log("click")},formatTel:function(e){var t=e.target.selectionStart,n=e.target.value,r=(n.slice(0,t).match(/\s/g)||[]).length,i=n.replace(/\s/g,""),o=i.substring(0,3).replace(/^(\w{3})/g,"$1 "),a=i.substring(3).replace(/^(\w{4})/g,"$1 "),s=e.target.value=o+a;this.mobile=i;var c=(s.slice(0,t).match(/\s/g)||[]).length;e.target.selectionEnd=e.target.selectionStart=t+c-r}}},v=(n(135),n(3)),p=Object(v.a)(f,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("p",{staticClass:"title"},[e._v("绑定手机")]),e._v(" "),n("div",{staticClass:"input-zone tel-zone"},[n("input",{ref:"mobile",attrs:{type:"text",placeholder:"请输入手机号",name:"user_mobile",maxlength:"13"},on:{focus:e.handleInput,input:e.formatTel}})]),e._v(" "),n("div",{staticClass:"input-zone code-zone"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.verifyCode,expression:"verifyCode"}],ref:"code",attrs:{type:"text",placeholder:"请输入验证码",name:"user_code",maxlength:"4"},domProps:{value:e.verifyCode},on:{input:function(t){t.target.composing||(e.verifyCode=t.target.value)}}}),e._v(" "),n("span",{staticClass:"code-btn",class:{"code-btn-disabled":!e.mobile},on:{click:e.getCode}},[e._v(e._s(e.text))])]),e._v(" "),n("button",{staticClass:"bind-btn",on:{click:e.handleBind}},[e._v("点击绑定")])])},[],!1,null,"514a1670",null);t.default=p.exports},33:function(e,t,n){"use strict";n.r(t),n.d(t,"isTel",function(){return r}),n.d(t,"isCode",function(){return i}),n.d(t,"setCookie",function(){return o}),n.d(t,"getCookie",function(){return a});n(74);function r(e){return/^1[3-9]\d{9}$/g.test(e)}function i(e){return/^\d{4}$/g.test(e)}function o(e,t,n){var r=new Date;r.setTime(Number(r)+n),document.cookie=e+"="+t+(null==n?"":";expires="+r.toGMTString())}function a(e){if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!==t){t=t+e.length+1;var n=document.cookie.indexOf(";",t);return-1===n&&(n=document.cookie.length),document.cookie.substring(t,n)}}return""}},45:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"e",function(){return l}),n.d(t,"d",function(){return d});var r=n(51),i=n(33),o=n(78).stringify,a=r.api;function s(){return a.post("/smart-piano/v4/user/sms_token")}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.post("/smart-piano/v4/user/send_verification_code",o(e))}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.post("/smart-piano/v4/user/sms_login",o(e))}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.getCookie("TOKEN");return console.log(n),a.get("/smart-piano/v4/search/".concat(e),{params:t,headers:{TOKEN:n}})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=i.getCookie("TOKEN");return a.post("/smart-piano/v4/user/favor",o(e),{headers:{TOKEN:t}})}},49:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);n(38),n(62),n(67);var r=n(68),i=n.n(r);var o=n(16),a=n.n(o);n.d(t,"api",function(){return s});var s=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,r=i.a.create(e);return i.a.defaults.timeout=n,(t=r).interceptors.request.use(function(e){return e},function(e){return console.error(e),Promise.reject(e)}),t.interceptors.response.use(function(e){return e.data.meta.code>=200&&e.data.meta.code<300?e:Promise.reject(e.data)},function(e){return Promise.reject(e.data||e.response&&e.response.data||{code:5001,message:"api error"})}),r}({baseURL:a.a.apiHost.replace(/\/$/,""),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},86:function(e,t,n){"use strict";var r=n(21),i=n(34),o=n(52),a=n(53);n(55)("match",1,function(e,t,n,s){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=s(n,e,this);if(t.done)return t.value;var c=r(e),u=String(this);if(!c.global)return a(c,u);var l=c.unicode;c.lastIndex=0;for(var d,f=[],v=0;null!==(d=a(c,u));){var p=String(d[0]);f[v]=p,""===p&&(c.lastIndex=o(u,i(c.lastIndex),l)),v++}return 0===v?null:f}]})}}]);
//# sourceMappingURL=4.800031e209409bee9fe2.js.map